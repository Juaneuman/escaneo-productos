<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Carrito de Compras</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        #camera { width: 100%; max-width: 400px; margin-bottom: 20px; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        table, th, td { border: 1px solid black; }
        th, td { padding: 10px; text-align: center; }
    </style>
</head>
<body>
    <h1>Escáner de Productos</h1>
// Cargar carrito desde Local Storage (si existe)
const savedCart = localStorage.getItem("cart");
const cart = savedCart ? JSON.parse(savedCart) : [];

// Variables
const cameraElement = document.getElementById('camera');
const outputElement = document.getElementById('output');
const cartElement = document.getElementById('cart');
const totalElement = document.getElementById('total');

// Inicializar lector de código de barras
const codeReader = new ZXing.BrowserBarcodeReader();

codeReader.decodeFromVideoDevice(undefined, cameraElement, (result, err) => {
    if (result) {
        const code = result.text;
        outputElement.textContent = `Código escaneado: ${code}`;

        // Buscar producto en la base de datos
        if (productsDB[code]) {
            addToCart(productsDB[code]);
        } else {
            alert("Producto no encontrado");
        }
    }
});

// Función para agregar productos al carrito
function addToCart(product) {
    const existingProduct = cart.find(item => item.name === product.name);

    if (existingProduct) {
        const confirmAdd = confirm(`El producto "${product.name}" ya está en el carrito. ¿Deseas agregarlo nuevamente?`);
        if (!confirmAdd) {
            return;
        }
    }

    cart.push(product);
    updateCart();
}

// Actualizar el carrito
function updateCart() {
    // Limpiar tabla
    cartElement.innerHTML = "";
    let total = 0;

    // Agregar filas
    cart.forEach((item, index) => {
        total += item.price;
        const row = document.createElement("tr");
        row.innerHTML = `
            <td>${item.name}</td>
            <td>$${item.price}</td>
            <td><button onclick="removeFromCart(${index})">Eliminar</button></td>
        `;
        cartElement.appendChild(row);
    });

    // Actualizar total
    totalElement.textContent = total;

    // Guardar carrito en Local Storage
    localStorage.setItem("cart", JSON.stringify(cart));
}

// Eliminar producto del carrito
function removeFromCart(index) {
    cart.splice(index, 1);
    updateCart();
}

// Cargar carrito al inicio
updateCart();

    </script>
</body>
</html>
